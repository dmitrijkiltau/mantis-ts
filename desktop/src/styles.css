@import "./assets/css/theme.css";

@layer base {
  * {
    @apply box-border;
  }

  body {
    @apply relative isolate min-h-screen font-mono antialiased;
    background: radial-gradient(
        ellipse at top left,
        rgba(16, 185, 129, 0.15),
        transparent 50%
      ),
      radial-gradient(
        ellipse at bottom right,
        rgba(34, 211, 238, 0.12),
        transparent 50%
      ),
      #0a0e14;
    color: #00ff88;

    &::before {
      content: "";
      @apply pointer-events-none fixed inset-0 z-0 opacity-5;
      background-image: 
        repeating-linear-gradient(
          0deg,
          transparent,
          transparent 2px,
          rgba(0, 255, 136, 0.03) 2px,
          rgba(0, 255, 136, 0.03) 4px
        );
      animation: scanlines 8s linear infinite;
    }
  }

  @keyframes scanlines {
    0% { transform: translateY(0); }
    100% { transform: translateY(4px); }
  }

  button {
    @apply inline-flex items-center justify-center px-6 py-2;
    @apply text-sm font-semibold cursor-pointer;
    @apply transition duration-200 ease-out;
    font-family: var(--font-mono);

    &:hover {
      @apply brightness-125;
    }

    &:active {
      @apply scale-95;
    }

    &:disabled {
      @apply cursor-not-allowed opacity-40;
    }
  }
}

@layer components {
  .app-shell {
    @apply relative z-10 mx-auto flex min-h-screen w-full max-w-4xl flex-col gap-8 px-4 py-8;
  }

  /* Avatar Zone with Speech Bubble */
  .avatar-zone {
    @apply relative flex flex-col items-center gap-4;
    
    .avatar-canvas {
      @apply w-48 h-48 grid place-items-center;
      filter: drop-shadow(0 0 30px rgba(0, 255, 136, 0.5));
      
      .assistant-avatar-svg {
        @apply transition-transform duration-500 ease-out;
      }

      &:hover .assistant-avatar-svg {
        @apply scale-110;
      }
    }

    .speech-bubble {
      @apply relative bg-surface-solid rounded-xl p-6 max-w-2xl;
      background: rgba(15, 35, 25, 0.95);
      border: 2px solid #00ff88;
      box-shadow: 
        0 0 20px rgba(0, 255, 136, 0.3),
        inset 0 0 30px rgba(0, 255, 136, 0.05);
      animation: bubble-appear 0.4s ease-out;

      &.hidden {
        @apply hidden;
      }

      .bubble-content {
        @apply text-base leading-relaxed;
        color: #00ff88;
        font-family: var(--font-mono);
      }

      .bubble-tail {
        @apply absolute;
        width: 0;
        height: 0;
        border-left: 15px solid transparent;
        border-right: 15px solid transparent;
        border-bottom: 20px solid #00ff88;
        top: -20px;
        left: 50%;
        transform: translateX(-50%) rotate(180deg);
        filter: drop-shadow(0 2px 4px rgba(0, 255, 136, 0.3));
      }
    }
  }

  @keyframes bubble-appear {
    from {
      opacity: 0;
      transform: translateY(-10px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* Input Terminal */
  .input-terminal {
    @apply rounded-lg overflow-hidden;
    background: rgba(10, 20, 15, 0.9);
    border: 2px solid rgba(0, 255, 136, 0.4);
    box-shadow: 
      0 0 30px rgba(0, 255, 136, 0.2),
      inset 0 1px 0 rgba(0, 255, 136, 0.1);

    .terminal-header {
      @apply flex items-center justify-between px-4 py-2;
      background: rgba(0, 255, 136, 0.1);
      border-bottom: 1px solid rgba(0, 255, 136, 0.3);

      .terminal-title {
        @apply text-xs font-bold tracking-wider;
        color: #00ff88;
        text-shadow: 0 0 10px rgba(0, 255, 136, 0.8);
      }

      .status-indicator {
        @apply text-xs px-3 py-1 rounded;
        background: rgba(0, 255, 136, 0.2);
        color: #00ff88;
        border: 1px solid rgba(0, 255, 136, 0.4);
        animation: pulse 2s ease-in-out infinite;

        &[data-mood='listening'] {
          background: rgba(34, 211, 238, 0.2);
          color: #22d3ee;
          border-color: rgba(34, 211, 238, 0.4);
        }

        &[data-mood='thinking'] {
          background: rgba(245, 158, 11, 0.2);
          color: #f59e0b;
          border-color: rgba(245, 158, 11, 0.4);
        }

        &[data-mood='speaking'] {
          background: rgba(16, 185, 129, 0.2);
          color: #10b981;
          border-color: rgba(16, 185, 129, 0.4);
        }
      }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    #prompt-form {
      @apply flex flex-col gap-0;
    }

    .terminal-input {
      @apply w-full px-4 py-4 bg-transparent resize-y;
      color: #00ff88;
      border: none;
      outline: none;
      font-family: var(--font-mono);
      min-height: 100px;

      &::placeholder {
        color: rgba(0, 255, 136, 0.4);
      }

      &:focus {
        background: rgba(0, 255, 136, 0.02);
      }
    }

    .terminal-button {
      @apply self-end mx-4 mb-4 px-6 py-2;
      background: rgba(0, 255, 136, 0.15);
      border: 2px solid #00ff88;
      color: #00ff88;
      font-weight: bold;
      letter-spacing: 0.1em;
      transition: all 0.2s;

      .button-bracket {
        @apply inline-block transition-transform;
      }

      &:hover {
        background: rgba(0, 255, 136, 0.25);
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
        
        .button-bracket:first-child {
          transform: translateX(-3px);
        }
        
        .button-bracket:last-child {
          transform: translateX(3px);
        }
      }

      &:disabled {
        opacity: 0.3;
        cursor: not-allowed;
      }
    }
  }

  /* Pip-Boy Style Tablet */
  .pip-tablet {
    @apply rounded-lg overflow-hidden;
    background: linear-gradient(135deg, rgba(15, 30, 20, 0.95), rgba(10, 25, 15, 0.95));
    border: 3px solid rgba(0, 255, 136, 0.6);
    box-shadow: 
      0 10px 50px rgba(0, 255, 136, 0.3),
      inset 0 0 50px rgba(0, 255, 136, 0.05);
    position: relative;

    &::before {
      content: "";
      @apply absolute inset-0 pointer-events-none;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 255, 136, 0.03) 2px,
        rgba(0, 255, 136, 0.03) 4px
      );
    }

    .tablet-header {
      @apply flex items-center justify-between px-5 py-3;
      background: rgba(0, 255, 136, 0.15);
      border-bottom: 2px solid rgba(0, 255, 136, 0.4);

      .tablet-title {
        @apply flex items-center gap-2 text-sm font-bold tracking-wider;
        color: #00ff88;
        text-shadow: 0 0 10px rgba(0, 255, 136, 0.8);

        .title-icon {
          @apply inline-block;
          animation: rotate 4s linear infinite;
        }
      }

      .tablet-stats {
        @apply flex gap-4 text-xs;

        .stat-item {
          @apply px-2 py-1 rounded;
          background: rgba(0, 0, 0, 0.4);
          color: #00ff88;
          border: 1px solid rgba(0, 255, 136, 0.3);
          font-family: var(--font-mono);
        }
      }
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .tablet-tabs {
      @apply flex border-b-2 border-b-[rgba(0,255,136,0.3)];
      background: rgba(0, 0, 0, 0.3);

      .tab-button {
        @apply flex-1 px-4 py-3 text-xs font-bold tracking-wider;
        color: rgba(0, 255, 136, 0.5);
        border-right: 1px solid rgba(0, 255, 136, 0.2);
        transition: all 0.2s;

        &:last-child {
          border-right: none;
        }

        &:hover {
          background: rgba(0, 255, 136, 0.1);
          color: rgba(0, 255, 136, 0.8);
        }

        &.active {
          background: rgba(0, 255, 136, 0.2);
          color: #00ff88;
          box-shadow: inset 0 -2px 0 #00ff88;
        }
      }
    }

    .tablet-screen {
      @apply relative p-5 min-h-[400px];
      background: rgba(0, 0, 0, 0.4);

      .scan-line {
        @apply absolute left-0 right-0 h-[2px] pointer-events-none;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(0, 255, 136, 0.4),
          transparent
        );
        animation: scan 3s linear infinite;
      }

      @keyframes scan {
        0% { top: 0; }
        100% { top: 100%; }
      }

      .tablet-panel {
        @apply hidden;

        &.active {
          @apply block;
          animation: panel-fade-in 0.3s ease-out;
        }
      }

      @keyframes panel-fade-in {
        from {
          opacity: 0;
          transform: translateX(-10px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
    }

    .status-display {
      @apply flex flex-col gap-3;

      .status-row {
        @apply flex items-center gap-3 px-4 py-3 rounded;
        background: rgba(0, 255, 136, 0.05);
        border-left: 3px solid rgba(0, 255, 136, 0.5);

        .status-label {
          @apply text-xs font-bold tracking-wider;
          color: rgba(0, 255, 136, 0.7);
          min-width: 120px;
        }

        .status-value {
          @apply text-sm font-mono;
          color: #00ff88;
          text-shadow: 0 0 5px rgba(0, 255, 136, 0.5);
        }
      }
    }

    .history-list {
      @apply flex flex-col gap-3 max-h-[400px] overflow-y-auto;

      &::-webkit-scrollbar {
        width: 8px;
      }

      &::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.3);
      }

      &::-webkit-scrollbar-thumb {
        background: rgba(0, 255, 136, 0.4);
        border-radius: 4px;

        &:hover {
          background: rgba(0, 255, 136, 0.6);
        }
      }

      .answer-card {
        @apply p-4 rounded;
        background: rgba(0, 255, 136, 0.08);
        border: 1px solid rgba(0, 255, 136, 0.3);

        h3 {
          @apply text-sm font-bold mb-2;
          color: #22d3ee;
          text-shadow: 0 0 5px rgba(34, 211, 238, 0.5);
        }

        pre {
          @apply text-xs whitespace-pre-wrap mt-2 p-2 rounded;
          background: rgba(0, 0, 0, 0.4);
          color: #00ff88;
          border: 1px solid rgba(0, 255, 136, 0.2);
        }

        p {
          @apply text-xs mt-2;
          color: rgba(0, 255, 136, 0.7);
        }
      }
    }

    .logs-console {
      @apply flex flex-col gap-1 max-h-100 overflow-y-auto text-xs font-mono;

      &::-webkit-scrollbar {
        width: 8px;
      }

      &::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.3);
      }

      &::-webkit-scrollbar-thumb {
        background: rgba(0, 255, 136, 0.4);
        border-radius: 4px;
      }

      .log-entry {
        @apply py-1 px-2;
        color: rgba(0, 255, 136, 0.8);
        border-bottom: 1px solid rgba(0, 255, 136, 0.1);

        &:hover {
          background: rgba(0, 255, 136, 0.05);
        }
      }
    }
  }
}
